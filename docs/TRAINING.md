# Training a SSPINN Neural Net

This guide will walk you through training a neural network using the SSPINN
framework. It assumes the package is already installed correctly.

First, the data files need to be extracted. From the `SSPINN` directory,
```
$ cd data
$ tar -xvf data.tar.xz
```

The data directory should now hold 3 subdirectories: `data`, `test_data`, and
`train_data`. The test and training data split have been generated by the files
`get_test.sh` and `permute.py`, which can be re-run to generate the test and
train data again. Note that for reproducibility, a known seed has been used to
generate the random permutations. If a new training and testing data split is
desired, simply change the seed in `permute.py`:
```
np.random.seed(<insert desired seed>)
```

The Predictor object expects a numpy array of data as an input if it is
training. To generate the files that hold this information, a parallel enabled
method for generating this from the data split has been included in
`nn_translator.py`. To generate this data, run the following command from the
`SSPINN` directory:
```
$ python sspinn/nn_translator.py <# of parallel cores> data/train_data
```
Now the files `data/train_data/preprocessed_input.npy` and
`data/train_data/preprocessed_target.npy` should exist, and you are ready to
train.

Either using the default network or specifying your own through the
`Predictor.set_nn` method, instantiate a `Predictor` object with a network. The
training can be done by
```
from sspinn.predict import Predictor

pred = Predictor(train=True, data_dir='data/train_data')
pred.train()
```

Note that this may take a while, and it is highly recommended to perform the
training on high-performance machines.

At the end of the training process, the best network has been saved at
`sspinn/nets/last_trained.h5`, and is ready for prediction. 
